if(typeof JSON=="undefined"){var tmp=document.createElement("script");tmp.type="text/javascript";var scriptTags=document.getElementsByTagName("script");for(var i=0;i<scriptTags.length;i++){if(scriptTags[i].src.lastIndexOf("nirvana.js")>0){tmp.src=scriptTags[i].src.replace("nirvana.js","json2.js");break;}}document.getElementsByTagName("head")[0].appendChild(tmp);}(function(b,c){var a=(function(){var aa={SESSION_START:1,RESOURCE_SUBSCRIBE:2,KEEP_ALIVE:3,BATCH_SUBSCRIBE:5,PACKET_RECEIVE:7,EVENT_RECEIVE:8,SET_RESOURCE_ALIAS:10,RESOURCE_PUBLISH:14,RESOURCE_UNSUBSCRIBE:15,QUEUE_COMMIT:16,QUEUE_ROLLBACK:17,TX_PUBLISH:20,TX_IS_COMMITTED:24,CLIENT_CLOSE:30};var u={START:1,STOP:2,DISCONNECT:3,RECONNECT:4,ERROR:5,DATA:6,DRIVER_CHANGE:7,SUBSCRIBE:8,UNSUBSCRIBE:9,COMMIT:10,ROLLBACK:11,PUBLISH:13};var Q={NOTSTARTED:"NOTSTARTED",CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",RECONNECTING:"RECONNECTING",STOPPED:"STOPPED"};var n="_Nirvana_Driver_DOM_Objects_Container";var j={};var L=null;var W=(function(){var ao=9;var am=false;var aG=(function(){var aM=[];var aS=10000;var aK=false;var aO;var aL=function(aV){};function aP(aV,aW){if(ao<=aV){var aY=Array.prototype.slice.call(arguments);aY.unshift(new Date());var aX=aY.join(" ");if(aK&&aO&&!aO.closed){aO.document.writeln(aX+"<br/>");}if(aM.length>aS){aM.shift();}aM.push(aX);aL(aX);}}function aN(aV,aW){var aX="EXCEPTION: "+aW.name+" - "+aW.message;aP(aV,aX);}function aT(aV){aL=aV;}function aQ(aV){if(!aV){aV=b.event;}if((aV.keyCode==68)&&aV.ctrlKey&&aV.altKey){aU();}}function aU(){if(!aK||(aO&&aO.closed)){aO=b.open("","Console","width=600,height=300,scrollbars=yes,resizable");aO.document.open();aO.document.writeln("<style> { font-size: 10px; font-family: verdana, lucida sans, courier new, courier, sans-serif ; }</style>");aO.document.writeln("<b>User Agent: "+navigator.userAgent+"</b><br/>");for(var aV=0;aV<aM.length;aV++){aO.document.writeln(aM[aV]+"<br/>");}aK=true;}else{aO.focus();}}try{if(b.addEventListener){b.addEventListener("keydown",aQ,false);}else{if(document.attachEvent){document.attachEvent("onkeydown",aQ);}else{document.addEventListener("keydown",aQ,true);}}}catch(aR){}return{setLogger:aT,log:aP,logException:aN};}());var aJ=function(){return am;};var aB=function(aK){ao=aK;am=ao<9;};var ax=function(aL,aK){document.cookie=aL+"="+encodeURIComponent(aK)+"; expires="+new Date((new Date()).getTime()+365*24*60*60*1000)+"; ";};var aC=function(aN){var aL=document.cookie.split("; ");for(var aK=0;aK<aL.length;aK++){var aM=aL[aK].split("=");if(aM[0]==aN){return decodeURIComponent(aM[1]);}}return null;};var aq=(function(){var aK=500;var aQ=0;var aM=0;var aL={};function aR(aT,aS){var aU=aM++;aL[aU]={t:aQ+aS,f:aT};return aU;}function aO(aT){try{if(aL[aT]){delete aL[aT];}}catch(aS){}}function aN(){aQ+=aK;aP();setTimeout(aN,aK);}function aP(){for(var aT in aL){if(aL.hasOwnProperty(aT)){var aS=aL[aT];if(aQ>=aS.t){(aS.f)();aO(aT);}}}}aN();return{schedule:aR,cancel:aO};}());var aH=function(){var aP=[];var aL=function(aQ){if(ad.getNirvanaCookie()!==c){return"&Connection-Type=JR&"+ad.getNirvanaCookie()+"&R="+aQ.requestID;}else{return"&R="+aQ.requestID;}};var aN=function(aR){var aQ="";if(aR.hasTag()){aQ=aQ+"&T="+W.base64Encode(aR.getTag());}if(aR.hasData()){aQ=aQ+"&D="+aR.getData(a.BYTE_ARRAY_AS_BASE64_STRING);}if(aR.hasDictionary()){aQ=aQ+"&J="+aO(aR.getDictionary());}aQ=aQ+"&L="+aR.getTTL()+aM(aR.getEventAttributes());return aQ;};var aO=function(aW){var aY=aW.getKeys();var aZ=aY.length;var aS="";for(var aT=0;aT<aZ;aT++){if(aT>0){aS+=",";}var aX=aY[aT];var aU=aW.getType(aX);aS+=encodeURIComponent(aX)+","+aU;if(aU===l.ARRAY){aU=aW.getArrayType(aX);var aQ=aW.get(aX);if(aU===l.STRING||aU===l.CHARACTER){var aR=[];for(var aV=0;aV<aQ.length;aV++){aR[aV]=encodeURIComponent(aQ[aV]);}aQ=aR;}aS+=","+aU+","+aQ.length+","+aQ.join(",");}else{if(aU===l.DICTIONARY){aS+=","+aO(aW.get(aX));}else{if(aU===l.STRING||aU===l.CHARACTER){aS+=","+encodeURIComponent(aW.get(aX));}else{aS+=","+aW.get(aX);}}}}return aS;};var aM=function(aT){var a0=0;var aS=[];var aU=h.HEADER_KEYS;var aZ=aU.length;for(var aX=0;aX<aZ;aX++){var aQ=aT.getAttribute(aU[aX]);if(aQ||aQ===0){a0=a0+(1<<aX);aS.push(encodeURIComponent(aQ));}}if(aT.getMessageType()>-1&&aT.getMessageType()<7){var aR=h.JMS_HEADER_KEYS;var aV=aR.length;for(var aY=0;aY<aV;aY++){var aW=aT.getAttribute(aR[aY]);if(aW||aW===0){a0=a0+(1<<(aZ+aY));aS.push(encodeURIComponent(aW));}}}if(a0>0){return"&K="+a0+"&H="+aS.join(",");}return"";};aP[aa.SESSION_START]=function(aR){var aQ=aR.session;return["F="+aa.SESSION_START+"&Connection-Type=JC&Y=9&V="+navigator.appName.replace(" ","-")+"&P="+ad.Drivers.WireProtocol[ad.getCurrentDriver()]+"&W="+a.BUILD_NUMBER.replace(" ","-")+"&X="+a.BUILD_DATE.replace(" ","-")+"&Z="+navigator.platform.toString().replace(" ","_")+"&S="+encodeURIComponent(aQ.getUsername())+"&A="+encodeURIComponent(aQ.getConfig().applicationName)+"&G="+(aQ.getConfig().serverLogging?"T":"F")+"&D="+(aQ.isDataStreamEnabled()?"T":"F")+"&R="+aR.requestID,""];};aP[aa.CLIENT_CLOSE]=function(aQ){return["F="+aa.CLIENT_CLOSE+aL(aQ),""];};aP[aa.KEEP_ALIVE]=function(aQ){return["F="+aa.KEEP_ALIVE+aL(aQ),""];};aP[aa.BATCH_SUBSCRIBE]=function(aX){var aW="";var aV=aX.resources;var aQ=aV.length;for(var aS=0;aS<aQ;aS++){var aU=aV[aS];var aT=aU.getResourceType();if(aS>0){aW+=",";}aW+=aU.getName();if(aT===a.CHANNEL_RESOURCE){var aR;if(aU.getCurrentEID()>=0){aR=aU.getCurrentEID()+1;}else{aR=aU.getStartEID();}aW+=","+aR;aW+=","+encodeURIComponent(aU.getFilter());aW+=",F";}else{if(aT===a.QUEUE_RESOURCE){aW+=",0";aW+=","+encodeURIComponent(aU.getFilter());aW+=",T";}else{if(aT===a.TRANSACTIONAL_QUEUE_RESOURCE){aW+=","+aU.getWindowSize();aW+=","+encodeURIComponent(aU.getFilter());aW+=",T";}else{aW+=",0";aW+=","+encodeURIComponent(aU.getFilter());aW+=",F";}}}}return["F="+aa.BATCH_SUBSCRIBE+aL(aX),"E="+aQ+"&N="+aW];};aP[aa.RESOURCE_SUBSCRIBE]=function(aQ){aQ.resources=[aQ.resource];return aP[aa.BATCH_SUBSCRIBE](aQ);};aP[aa.RESOURCE_PUBLISH]=function(aS){var aR=aS.resource;var aQ=aS.event;return["F="+aa.RESOURCE_PUBLISH+aL(aS),"N="+aR.getName()+aN(aQ)];};aP[aa.RESOURCE_UNSUBSCRIBE]=function(aT){var aS=aT.resource;var aR=aS.getResourceType();var aQ=["F="+aa.RESOURCE_UNSUBSCRIBE+aL(aT),"N="+aS.getName()];if(aR===a.QUEUE_RESOURCE||aR===a.TRANSACTIONAL_QUEUE_RESOURCE){aQ[1]=aQ[1]+"&Q=T";}return aQ;};aP[aa.QUEUE_COMMIT]=function(aS){var aR=aS.resource;var aQ=aS.event;return["F="+aa.QUEUE_COMMIT+aL(aS),"N="+aR.getName()+"&E="+aQ.getEID()];};aP[aa.QUEUE_ROLLBACK]=function(aS){var aR=aS.resource;var aQ=aS.event;return["F="+aa.QUEUE_ROLLBACK+aL(aS),"N="+aR.getName()+"&E="+aQ.getEID()];};aP[aa.TX_PUBLISH]=function(aT){var aR=aT.resource;var aS=aT.transaction;var aQ=aT.event;return["F="+aa.TX_PUBLISH+aL(aT),"N="+aR.getName()+"&X="+aS.getTxID()+aN(aQ)];};aP[aa.TX_IS_COMMITTED]=function(aR){var aQ=aR.transaction;return["F="+aa.TX_IS_COMMITTED+aL(aR),"X="+aQ.getTxID()];};var aK=function(aQ){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Request Factory] Building Request from Command "+ac(aQ.requestType));}return(aP[aQ.requestType](aQ));};return{buildRequest:aK};};var ah=function(aO){var aN=[];var aM=false;var aK=function(aT,aU,aS){var aV;if(aT.Dictionary){aV=aP(aT.Dictionary);}var aR=new h(aT.h);var aQ;if(aT.Tag){aQ=W.base64Decode(aT.Tag);}return new V(aO,aT.EID,aU,aS,aR,aT.Data,aQ,aV);};var aP=function(aU){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Building Event Dictionary ",aU);}for(var aX in aU){if(aU.hasOwnProperty(aX)){var aW=aU[aX];if(aW[0]===l.STRING||aW[0]===l.CHARACTER){aW[1]=decodeURIComponent(aW[1]);}else{if(aW[0]===l.DICTIONARY){aW[1]=aP(aW[1]);}else{if(aW[0]===l.ARRAY){if(aW[1]===l.STRING||aW[1]===l.CHARACTER){var aY=aW[2];var aT=aY.length;for(var aS=0;aS<aT;aS++){aY[aS]=decodeURIComponent(aY[aS]);}}else{if(aW[1]===l.DICTIONARY){var aV=aW[2];var aQ=aV.length;for(var aR=0;aR<aQ;aR++){aV[aR]=aP(aV[aR]);}}}}}}}}return new l(aU);};aN[aa.SESSION_START]=function(aQ,aR){if(W.isLoggingEnabled()){W.Logger.log(6,"[HTTP Response Factory] Received Session Start Response for Command "+aR.requestType,aQ,aR);}if(aQ[1]){aO.setSessionID(aQ[2]);ad.onConnect(aQ[4]);s.setReady(true);if(aR.reconnect){aO.notifyListeners(u.RECONNECT,aO,aQ[3]);}else{aO.notifyListeners(u.START,aO,aQ[3]);}}else{if(W.isLoggingEnabled()){W.Logger.log(6,"[HTTP Response Factory] Session Connection Error: "+aQ[2]);}aO.notifyListeners(u.ERROR,aO,{name:"SessionConnectException",message:aQ[2]});}};aN[aa.BATCH_SUBSCRIBE]=function(aT,aS){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Batch Subscribe Callback for Command "+aS.requestType,aT,aS);}var aQ=aS.resources;var aY=aT.slice(1);var aU=aS.resubscribe;var aX=aQ.length;for(var aV=0;aV<aX;aV++){var aR=aQ[aV];var a1=aY[aV];var a0=a1[1];aR.setSubscribed(a0);if(a0){aR.setAlias(a1[2]);if(!aU){aR.notifyListeners(a.Observe.SUBSCRIBE,aR,"OK");}}else{var aW=a1[2];var aZ;if(aW){if(aW.indexOf("SECURITY")!==-1){aZ=new o(aW);}else{if(aW.indexOf("Channel Not Found")!==-1){aZ=new q(aR.getName(),aW);}else{aZ=new y(aW);}}}if(!aZ){aZ=new y("Unknown Error Occurred");}aR.notifyListeners(a.Observe.ERROR,aR,aZ);}}};aN[aa.KEEP_ALIVE]=function(aQ,aR){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Processing KA Response "+aQ.toString());}};aN[aa.RESOURCE_PUBLISH]=function(aQ,aV){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Publish Callback for Command "+aV.requestType,aQ,aV);}var aS=aV.resource;var aU=aQ[1];if(aU){aS.notifyListeners(u.PUBLISH,aS,aU);}else{var aT=aQ[2];var aR;if(aT&&aT.indexOf("SECURITY")!==-1){aR=new o(aT);}else{aR=new y(aT);}aS.notifyListeners(u.ERROR,aS,aR);}};aN[aa.RESOURCE_UNSUBSCRIBE]=function(aQ,aS){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Resource unsubscribe Callback for Command "+aS.requestType);}var aR=aS.resource;aR.setSubscribed(false);aR.notifyListeners(u.UNSUBSCRIBE,aR,"OK");};aN[aa.PACKET_RECEIVE]=function(aQ){if(aO.getLongPollRequestID()<aQ[1]){aO.setLongPollRequestID(aQ[1]);}else{ad.onError("Data received out of order, reset required. Expected packet "+(aO.getLongPollRequestID()+1)+" but received "+aQ[1]);}};aN[aa.EVENT_RECEIVE]=function(aW){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Event",aW);}var aT=aW[1];var aQ=aT.dg==="1";var aV;var aS;var aR;if(!aQ){aV=aO.getResourceByAlias(aT.CNAME);if(!aV){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Event was for non-existent resource: "+aT.CNAME);}return;}aS=aV.getResourceType();aR=aV.getName();}else{aV=aO;aS=-1;aR=aO.getGroupName(aT.CNAME);}var aU=aK(aT,aV,aR);if(aV){if(aS===a.CHANNEL_RESOURCE){aV.setCurrentEID(aU.getEID());}aV.notifyListeners(u.DATA,aU);}};aN[aa.SET_RESOURCE_ALIAS]=function(aT){var aS=aT[1];var aQ=aT[2];var aR=aT[3];if(aS=="3"){aO.setGroupAlias(aQ,aR);}else{aO.setResourceAlias(aQ,aR);}};aN[aa.QUEUE_COMMIT]=function(aQ,aS){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Queue Commit Response",aQ,aS);}var aR=aS.resource;aR.notifyListeners(u.COMMIT,aR,aQ[1]);};aN[aa.QUEUE_ROLLBACK]=function(aQ,aS){if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Received Queue Rollback Response",aQ,aS);}var aR=aS.resource;aR.notifyListeners(u.ROLLBACK,aR,aQ[1]);};aN[aa.TX_PUBLISH]=function(aR,aT){var aQ=aR[1];var aS=aT.transaction;if(aQ){aS.notifyListeners(u.COMMIT,aS,true);aS.setIsCommitted(true);}else{aS.notifyListeners(u.COMMIT,aS,false);aS.notifyListeners(u.ERROR,aS,aR[2]);aS.setIsCommitted(false);}};aN[aa.TX_IS_COMMITTED]=function(aQ,aS){var aR=aS.transaction;aR.notifyListeners(u.COMMIT,aR,aQ[1]);aR.setIsCommitted(true);};aN[aa.CLIENT_CLOSE]=function(aQ,aR){if(aR.clientRequest){if(W.isLoggingEnabled()){W.Logger.log(6,"[HTTP Response Factory] Received Client Close Session Response "+ac(aQ[0])+" for command "+ac(aR));}ad.stop();aO.notifyListeners(u.STOP,aO,true);}else{if(W.isLoggingEnabled()){W.Logger.log(4,"[HTTP Response Factory] Received Internal Close Session Response "+ac(aQ[0])+" for command "+ac(aR));}}};function aL(aR){var aS=aR.d;if(W.isLoggingEnabled()){W.Logger.log(3,"[HTTP Response Factory] Dispatching response "+ac(aS[0]));}var aQ=aS[0];if(aQ==aa.SESSION_START){aM=false;}if(!aM&&aQ!==aa.SESSION_START){aM=true;ad.setPreferredDriver();}if(aQ===aa.EVENT_RECEIVE||aQ===aa.PACKET_RECEIVE||aQ===aa.SET_RESOURCE_ALIAS){aN[aQ](aS);}else{var aT=s.dequeueCommand(aR.r);if(aT===null&&aQ!==aa.KEEP_ALIVE){if(W.isLoggingEnabled()){W.Logger.log(6,"[HTTP Response Factory] Command is null");}return false;}aN[aQ](aS,aT);if(aT!==null&&aQ!==aa.SESSION_START){return true;}}return false;}return{dispatchResponse:aL};};function an(aO,aM,aK,aL,aN){this.session=aO;this.proxyWin=null;this.initialized=false;this.initCallback=aL;this.proxyRealm=aK;this.proxyID=aM+aD.counter++;this.proxyIFrame=ap(aK+aO.getConfig().crossDomainPath+"/crossDomainProxy.html?proxyID="+this.proxyID+"&sessionID="+W.generateUniqueID()+"&validOrigins="+encodeURIComponent(aO.getConfig().currentDomain+","+aO.getConfig().realms.join(",")),aN);this.readyState=0;this.responseText="";this.status=0;aD.collection[this.proxyID]=this;}an.prototype.proxyRequest=function(aN,aK){if(this.proxyWin===null){this.proxyWin=this.proxyIFrame.contentWindow;}var aM=[this.proxyID,aN];for(var aL=0;aL<aK.length;aL++){aM.push(aK[aL]);}this.proxyWin.postMessage(JSON.stringify(aM),this.proxyRealm);};an.prototype.open=function(aM,aK,aL){this.proxyRequest("open",arguments);};an.prototype.send=function(){this.proxyRequest("send",arguments);};an.prototype.setRequestHeader=function(){this.proxyRequest("setRequestHeader",arguments);};an.prototype.abort=function(){this.proxyRequest("abort",arguments);};an.prototype.destroy=function(){aD.collection[this.proxyID]=null;};function au(){this.id=W.generateUniqueID();var aK="container"+this.id;var aM=document.createElement("div");aM.style.display="none";aM.setAttribute("id",aK);document.getElementById(n).appendChild(aM);var aL=navigator.appName=="Microsoft Internet Explorer";if(W.isLoggingEnabled()){W.Logger.log(2,"[FormSubmitter] Creating new FormSubmitter: "+this.id);}this.send=function(aN,aS){if(W.isLoggingEnabled()){W.Logger.log(2,"[FormSubmitter] Sending "+aN+"?"+aS[0]+"&"+aS[1]);}aj(aM,aL);var aP=document.createElement("form");aP.style.display="none";aP.style.position="absolute";aP.method="POST";aP.enctype="application/x-www-form-urlencoded";aP.acceptCharset="UTF-8";aM.appendChild(aP);var aQ;try{aQ=document.createElement('<iframe name="'+this.id+'">');}catch(aX){aQ=document.createElement("iframe");aQ.name=this.id;}aQ.id=this.id;aQ.style.display="none";aP.appendChild(aQ);aP.target=this.id;aP.action=aN+"?"+aS[0];try{var aU=aS[1].split("&");for(var aT=0;aT<aU.length;aT++){var aW=aU[aT].indexOf("=");if(aW>-1){var aY=aU[aT].substring(0,aW);var aR=aU[aT].substring(aW+1,aU[aT].length);var aO=document.createElement("input");aO.name=aY;aO.value=aR;aP.appendChild(aO);}}}catch(aV){if(W.isLoggingEnabled()){W.Logger.log(2,"[FormSubmitter] Exception: "+aV.message);}}aP.submit();};this.destroy=function(){aj(aM,aL);document.getElementById(n).removeChild(aM);};}function ay(aM){this.id=W.generateUniqueID();if(W.isLoggingEnabled()){W.Logger.log(2,"[JSONP_Poller] Creating new longpoller: "+this.id);}var aK="container"+this.id;var aQ=0;var aP=document.createElement("div");aP.style.display="none";aP.setAttribute("id",aK);var aL=document.createElement("link");aL.setAttribute("rel","shortcut icon");aL.setAttribute("href","about:blank");aP.appendChild(aL);document.getElementById(n).appendChild(aP);var aO=false;var aN=navigator.appName=="Microsoft Internet Explorer";this.send=function(aS,aV){var aU=aS+"?"+aV[0]+"&"+aV[1];if(W.isLoggingEnabled()){W.Logger.log(2,"[JSONP_Poller] Sending "+aU);}try{if(aO){aj(aP,aN);}else{aO=true;}var aR=document.createElement("script");aR.type="text/javascript";aR.src=aU;aR.onerror=aM;aP.appendChild(aR);aQ=0;}catch(aT){if(aQ++==5){aM("[JSONP_Poller] Exception: "+aT.message);}}};this.destroy=function(){aj(aP,aN);document.getElementById(n).removeChild(aP);};}function aj(aM,aL){if(aL){while(aM.hasChildNodes()){aM.removeChild(aM.lastChild);}}else{while(aM.hasChildNodes()){var aK=aM.removeChild(aM.lastChild);for(var aN in aK){delete aK[aN];}}}}function al(aM){if(W.isLoggingEnabled()){W.Logger.log(2,"[initXMLHTTP] for "+aM);}var aN=false;if(typeof b.XMLHttpRequest!="undefined"&&b.XMLHttpRequest){try{aN=new XMLHttpRequest();if(W.isLoggingEnabled()){W.Logger.log(2,"initXMLHTTP : Constructed XMLHttpRequest for ["+aM+"]");}return aN;}catch(aP){if(W.isLoggingEnabled()){W.Logger.log(2,"initXMLHTTP : Error constructing XMLHttpRequest for ["+aM+"]. error="+aP.message);}aN=false;}}else{if(typeof b.ActiveXObject!="undefined"&&b.ActiveXObject){var aL=["MSXML2.XMLHttp","Microsoft.XMLHttp","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0"];for(var aK=0;aK<aL.length;aK++){try{aN=new ActiveXObject(aL[aK]);if(W.isLoggingEnabled()){W.Logger.log(2,"initXMLHTTP : Constructed ActiveXObject XMLHttpRequest using ["+aL[aK]+"] for ["+aM+"]");}return aN;}catch(aO){if(W.isLoggingEnabled()){W.Logger.log(2,"initXMLHTTP : Error constructing ActiveXObject XMLHttpRequest :"+aL[aK]+" for ["+aM+"]. error="+aO.message);}aN=false;}}}else{if(W.isLoggingEnabled()){W.Logger.log(2,"initXMLHTTP : Failed to construct xmlHTTP object for ["+aM+"]");}aN=false;}}return aN;}if(!b.addEventListener){b.addEventListener=function(aL,aM,aK){attachEvent("on"+aL,function(){aM(event);});};}b.addEventListener("message",function(aO){if(!ae(ar(aO.origin))){j[b.Nirvana].notifyListeners(a.Observe.ERROR,null,new d("CrossDomainProxy","PostMessage Event Origin "+aO.origin+" does not equal any proxied realm origin "+ag()));return;}var aK=JSON.parse(aO.data);var aL=aK[0];var aN=aK[2];var aM=aD.collection[aL];if(aN=="init"){aM.initialized=true;aM.initCallback("initialized");}if(aN=="change"){if(aM.onreadystatechange){aM.responseText=aK[3];aM.readyState=aK[4];aM.status=aK[5];aM.onreadystatechange();}}if(aN=="iframe"){ad.c(JSON.parse(aK[3]));}if(aN=="sse"){ad.c(JSON.parse(aK[3]));}},false);var aD={counter:0,collection:{}};function ae(aK){aK=aK.toUpperCase();for(var aL in aD.collection){if(aD.collection.hasOwnProperty(aL)){if(ar(aD.collection[aL].proxyRealm).toUpperCase()==aK){return true;}}}return false;}function ag(){var aL=[];for(var aK in aD.collection){if(aD.collection.hasOwnProperty(aK)){aL.push(ar(aD.collection[aK].proxyRealm));}}return aL.join(",");}function ap(aK,aM){var aN=document.createElement("iframe");aN.src=aK;aN.style.display="none";aN.style.position="absolute";aN.onerror=aM;try{document.getElementById(n).appendChild(aN);}catch(aL){aM("IFrame Exception: "+aL.message);}return aN;}function at(aO,aM,aQ){var aL;if(document.createElement){var aP=document.getElementById("NVLSubFrame");if(aP){aP.setAttribute("src",aO);aL=aP;}else{if(W.isLoggingEnabled()){W.Logger.log(2,"Iframe does not exist, so creating new one");}var aK='<iframe id="NVLSubFrame" onload="window.parent.errorCB(\'iframe_connection_closed\')" src="'+aO+'" style="';aK+="border:1px;";aK+="width:0px;";aK+="height:0px;";aK+='"></iframe>';if(b.ActiveXObject){this.htmlfile=new ActiveXObject("htmlfile");this.htmlfile.open();this.htmlfile.write("<html></html>");this.htmlfile.close();this.htmlfile.parentWindow.onMessage=aM;this.htmlfile.parentWindow.errorCB=aQ;var aN=this.htmlfile.createElement("div");this.htmlfile.body.appendChild(aN);aN.innerHTML+=aK;aL=this.htmlfile;}else{document.getElementById(n).innerHTML+=aK;aL={};aL.document={};aL.document.location={};aL.document.location.iframe=document.getElementById("NVLSubFrame");aL.document.location.replace=function(aR){this.iframe.src=aR;};}}}return aL;}var aw;var ak=function(aP,aN){var aM="";var aX,aV,aT,aW,aU,aS,aQ;var aO=0;var aL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var aR=function(aZ){var aY="";if(aZ<128){aY+=String.fromCharCode(aZ);}else{if((aZ>127)&&(aZ<2048)){aY+=String.fromCharCode((aZ>>6)|192);aY+=String.fromCharCode((aZ&63)|128);}else{aY+=String.fromCharCode((aZ>>12)|224);aY+=String.fromCharCode(((aZ>>6)&63)|128);aY+=String.fromCharCode((aZ&63)|128);}}return aY;};var aK=function(aZ){var aY="";aZ=aZ.replace(/\r\n/g,"\n");for(var a1=0;a1<aZ.length;a1++){var a0=aZ.charCodeAt(a1);aY+=aR(a0);}return aY;};if(!aN){aP=aK(aP);}while(aO<aP.length){if(aN){aX=aP[aO++];aV=aP[aO++];aT=aP[aO++];}else{aX=aP.charCodeAt(aO++);aV=aP.charCodeAt(aO++);aT=aP.charCodeAt(aO++);}aW=aX>>2;aU=((aX&3)<<4)|(aV>>4);aS=((aV&15)<<2)|(aT>>6);aQ=aT&63;if(aO-2===aP.length||isNaN(aV)){aS=aQ=64;}else{if(aO-1===aP.length||isNaN(aT)){aQ=64;}}aM=aM+aL.charAt(aW)+aL.charAt(aU)+aL.charAt(aS)+aL.charAt(aQ);}return aM;};if(typeof btoa==="undefined"){aw=ak;}else{aw=function(aL,aK){if(aK){return ak(aL,aK);}else{return btoa(aL);}};}var aE;var av=function(aQ,aL){var aN="";var aX,aV,aT;var aW,aU,aS,aR;var aO=0;var aM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var aP=function(aY){var a0="";var a2=0;var a1=0;var aZ=0;var a3=0;while(a2<aY.length){a3=aY.charCodeAt(a2);if(a3<128){a0+=String.fromCharCode(a3);a2++;}else{if((a3>191)&&(a3<224)){a1=aY.charCodeAt(a2+1);a0+=String.fromCharCode(((a3&31)<<6)|(a1&63));a2+=2;}else{a1=aY.charCodeAt(a2+1);aZ=aY.charCodeAt(a2+2);a0+=String.fromCharCode(((a3&15)<<12)|((a1&63)<<6)|(aZ&63));a2+=3;}}}return a0;};aQ=aQ.replace(/[^A-Za-z0-9\+\/=]/g,"");var aK=[];while(aO<aQ.length){aW=aM.indexOf(aQ.charAt(aO++));aU=aM.indexOf(aQ.charAt(aO++));aS=aM.indexOf(aQ.charAt(aO++));aR=aM.indexOf(aQ.charAt(aO++));aX=(aW<<2)|(aU>>4);aV=((aU&15)<<4)|(aS>>2);aT=((aS&3)<<6)|aR;aN=aN+String.fromCharCode(aX);if(aL){aK.push(aX);}if(aS!=64){aN=aN+String.fromCharCode(aV);if(aL){aK.push(aV);}}if(aR!=64){aN=aN+String.fromCharCode(aT);if(aL){aK.push(aT);}}}if(aL){return aK;}else{return aP(aN);}};if(typeof atob==="undefined"){aE=av;}else{aE=function(aL,aK){if(aK){return av(aL,aK);}else{return atob(aL);}};}var aA=0;function ai(){return aA++;}function aI(){var aK=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};return(aK()+aK()+"-"+aK()+"-"+aK()+"-"+aK()+"-"+aK()+aK()+aK());}function aF(aK){return aK.match(/https?:\/\/[^\/]+/)[0];}function az(aK){return aK.match(/^([a-z]+):\/\//)[0];}function ar(aK){aK=aF(aK);if(!aK.match(/:[0-9]+$/)){if(aK.match(/^https:/)){aK+=":443";}else{aK+=":80";}}return aK;}function af(aK){aK=aK.replace(/[^A-Za-z0-9\/_\-#]+/gi,"");if(aK.match(/^[^\/].*?\//)){aK="/"+aK;}return aK;}return{Logger:aG,Scheduler:aq,isLoggingEnabled:aJ,setDebugLevel:aB,HTTPRequestFactory:aH,HTTPResponseFactory:ah,createIFrame:ap,createForeverIFrame:at,initXMLHTTP:al,base64Encode:aw,base64Decode:aE,getCookie:aC,setCookie:ax,getCanonicalResourceName:af,getCanonicalOrigin:ar,getUrlProtocol:az,generateTransactionID:ai,generateUniqueID:aI,CrossDomainProxy:an,FormSubmitter:au,JSONP_Poller:ay};}());var ad=(function(){var ay;var aA=false;var au=null;var aD=0;var aQ;var ar=null;var aX;var af;var am=false;var aC=0;var al=0;var aZ=0;var aO=0;var a2=0;var aL=1000;var ag=3;var aR=(Math.floor(Math.random()*30)+30)*1000;var aU=60000;function ap(a4,a6){if(a6&&aV.length){return;}if(typeof a4=="undefined"){aV=ah;}else{var a5=[];for(var a8=0;a8<a4.length;a8++){var a9=a4[a8];if(typeof a.Driver[a9]!="undefined"){a5.push(a9);}else{j[b.Nirvana].notifyListeners(a.Observe.ERROR,aX,new J(a9));}}if(a5.length){aV=a5;}else{aV=ah;}}aZ=0;if(aX.getConfig().rememberDriver){var a7=W.getCookie("NirvanaDriver");if(a7!==null){for(var a3=0;a3<aV.length;a3++){if(aV[a3]==a7){aZ=a3;}}}}aX.notifyListeners(a.Observe.DRIVER_CHANGE,aX,aV[aZ]);}function a1(){var a3=ad.getCurrentDriver();aV=[a3];aZ=0;if(W.isLoggingEnabled()){W.Logger.log(7,"[Transport] Settled on preferred driver: "+a3);}if(aw().rememberDriver){if(W.getCookie("NirvanaDriver")===null){W.setCookie("NirvanaDriver",a3);}}}function aq(){if(W.isLoggingEnabled()){W.Logger.log(4,"[Transport] Remaining drivers: "+aV.join());}if(aV.length>1){aZ=(aZ+1)%aV.length;if(aZ>0||af.realms.length===1){aX.notifyListeners(a.Observe.DRIVER_CHANGE,aX,aV[aZ]);}al=0;}if(aZ===0){a0();}}function a0(){var a3=(aO+1)%af.realms.length;if(aO!=a3){if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Moving to another realm: "+af.realms[a3]);}aO=a3;aX.notifyListeners(a.Observe.REALM_CHANGE,aX,af.realms[aO]);aC=0;al=0;ap(aX.getConfig().drivers,false);}}function ao(){if(aV.length){var a3=aM.createDriver(aV[aZ]);if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Attempting to use Driver: "+a3.name);}if(!a3.isClientSupported()){if(W.isLoggingEnabled()){W.Logger.log(7,"[Transport] Driver not supported: "+a3.name);}aV.splice(aZ,1);if(aV.length<=aZ){aZ=0;}aX.notifyListeners(a.Observe.DRIVER_CHANGE,aX,aV[aZ]);return ao();}else{return a3;}}else{return null;}}function ax(a3){return aM.createDriver(a3).isClientSupported();}function aP(a4,a3){if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Setting Up");}aX=a4;af=a4.getConfig();ap(af.drivers,a3);}function aF(){if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Opening Driver to "+af.realms[aO]);}aX.setLongPollRequestID(-1);aQ=ad.initializeDriver();if(aQ!==null){aQ.open();ae("driver.open",af.openDriverTimeout);}else{var a3=new G(af.drivers);aX.notifyListeners(a.Observe.ERROR,aX,a3);j[b.Nirvana].notifyListeners(a.Observe.ERROR,aX,a3);}}function av(){am=false;if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Tearing Down Driver");}if(aQ!==null){s.setReady(false);clearTimeout(ay);aT();aQ.close();aQ=null;if(aX.getStatus()==="CONNECTED"){aX.notifyListeners(a.Observe.DISCONNECT,aX,"Session Disconnected");}}}function aY(){return aV[aZ];}function aW(){return af.realms[aO];}function aS(){return aX;}function aw(){return af;}function aE(){aD++;return aD;}function aB(){av();aD=0;}function an(){return ar;}function at(a3){ar=a3;al=0;a2=new Date();am=true;}function aK(){return am;}function aG(){if(W.isLoggingEnabled()){W.Logger.log(4,"[Transport] Received Driver OnOpen Callback");}if(aX.getStatus()==Q.CONNECTING){s.resetMessagesOnQueue();}s.setReady(true);}function az(a3){al++;s.setReady(false);if(W.isLoggingEnabled()){W.Logger.log(4,"[Transport] Received Driver OnError Callback with error: "+a3);}if(aX.getStatus()==="STOPPED"){av();}else{if(W.isLoggingEnabled()){W.Logger.log(3,"[Transport] Driver failure count: "+al);}if(al>=ag){if(W.isLoggingEnabled()){W.Logger.log(3,"[Transport] Driver failure reached maximum permitted count: "+ag);}aq();}ai("Driver Error: "+a3);}}function aN(){if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Received Driver OnClose Callback");}}function aT(){if(au!==c){if(W.isLoggingEnabled()){W.Logger.log(2,"[Transport] Clearing Scheduler resetTimeoutID : "+au);}W.Scheduler.cancel(au);au=null;}}function ae(a3,a4){aT();au=W.Scheduler.schedule(function(){az("Request Timed Out, "+a3);},a4);if(W.isLoggingEnabled()){W.Logger.log(2,"[Transport] Setting Scheduler resetTimeoutID  : "+au);}}function aJ(a4){if(aQ===null){return;}aA=true;var a3=aX.requestFactory.buildRequest(a4);if(W.isLoggingEnabled()){W.Logger.log(3,"[Transport] Sending request number "+a4.requestID+" of "+aD+" for "+ac(a4.requestType)+" "+a3);}if(aQ&&aQ.usesKeepAlive()){ak(a4.session);}ae(a3,af.sendResponseTimeout);aQ.send(a4,a3);}function aj(a5){if(W.isLoggingEnabled()){W.Logger.log(2,"[Transport] Receiving Data: "+JSON.stringify(a5));}aC=0;aT();aA=false;var a3=false;if(a5){for(var a4=0;a4<a5.length;a4++){if(aX.responseFactory.dispatchResponse(a5[a4])){a3=true;if((a5[a4].d)[0]==aa.CLIENT_CLOSE){return a3;}}}}return a3;}function aH(a3){if(a3.length>0){return aj(JSON.parse(a3));}return false;}function ak(a3){if(W.isLoggingEnabled()){W.Logger.log(2,"[Transport] (Re)Scheduling KeepAlive to occur in "+aU+" ms");}clearTimeout(ay);ay=setTimeout(function(){aI(a3);},aU);}function aI(a3){if(aA){if(W.isLoggingEnabled()){W.Logger.log(2,"[Transport] Currently inRequest.");}ak(a3);}else{if(W.isLoggingEnabled()){W.Logger.log(3,"[Transport] Sending KeepAlive");}s.prioritizeCommand({requestType:aa.KEEP_ALIVE,session:a3});}}function ai(bb){if(W.isLoggingEnabled()){W.Logger.log(7,"[Transport] Resetting the Session. Reason: "+bb);}av();var a3=aX.getStatus();var bc;if(af.realms.length>1){bc=aL*al;}else{bc=Math.min(aR,aL*aC);}if(a3==="CONNECTING"){aC++;if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Recreating Driver to CONNECT. Delaying open() for "+bc+"ms");}setTimeout(aF,bc);}if(aX.getStatus()==="CONNECTED"){if(W.isLoggingEnabled()){W.Logger.log(4,"[Transport] Adding Restart Request to Outbound Engine");}if(a2+10000<new Date()){aC=0;}aX.setStatus("RECONNECTING");var a5=[];var a4=aX.getResources();var a6=a4.length;for(var ba=0;ba<a6;ba++){if(a4[ba].isSubscribed()){a5.push(a4[ba]);}}if(a5.length>0){var a7={requestType:aa.BATCH_SUBSCRIBE,session:aX,resources:a5,resubscribe:true};s.prioritizeCommand(a7);}var a8={requestType:aa.SESSION_START,session:aX,reconnect:true};s.prioritizeCommand(a8);s.resetMessagesOnQueue();}if(aX.getStatus()==="RECONNECTING"){aC++;var a9=s.peek();if(a9===null||a9===c||a9.requestType!==aa.SESSION_START){s.prioritizeCommand({requestType:aa.SESSION_START,session:aX,reconnect:true});}if(W.isLoggingEnabled()){W.Logger.log(6,"[Transport] Recreating Driver to RECONNECT. Delaying open() for "+bc+"ms");}setTimeout(aF,bc);}}var aM=(function(){var a5={WEBSOCKET:"WEBSOCKET",XHR_STREAMING_CORS:"XHR_STREAMING_CORS",XDR_STREAMING:"XDR_STREAMING",IFRAME_STREAMING_POSTMESSAGE:"IFRAME_STREAMING_POSTMESSAGE",EVENTSOURCE_STREAMING_POSTMESSAGE:"EVENTSOURCE_STREAMING_POSTMESSAGE",XDR_LONGPOLL:"XDR_LONGPOLL",XHR_LONGPOLL_CORS:"XHR_LONGPOLL_CORS",XHR_LONGPOLL_POSTMESSAGE:"XHR_LONGPOLL_POSTMESSAGE",JSONP_LONGPOLL:"JSONP_LONGPOLL",NOXD_IFRAME_STREAMING:"NOXD_IFRAME_STREAMING"};var a3={WEBSOCKET:"nws",XHR_STREAMING_CORS:"ncc",XDR_STREAMING:"ncc",IFRAME_STREAMING_POSTMESSAGE:"nsc",EVENTSOURCE_STREAMING_POSTMESSAGE:"nsse",XDR_LONGPOLL:"nlpc",XHR_LONGPOLL_CORS:"nlpc",XHR_LONGPOLL_POSTMESSAGE:"nlp",JSONP_LONGPOLL:"nlpj",NOXD_IFRAME_STREAMING:"nsc"};function a6(a8){return new a4[a8](a8);}var a4={};a4[a5.WEBSOCKET]=function(a9){var ba=true;var a8;this.name=a9;this.isClientSupported=function(){return("WebSocket" in b||"MozWebSocket" in b);};this.usesKeepAlive=function(){return true;};this.open=function(){ba=false;if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}var bd;var bc=document.createElement("a");bc.href=ad.getCurrentRealm();if(bc.protocol==="http:"){bd="ws://"+bc.host;}else{bd="wss://"+bc.host;}bd+="/sv/ws";if("WebSocket" in b){a8=new WebSocket(bd);}else{if("MozWebSocket" in b){a8=new MozWebSocket(bd);}else{return false;}}var bb=function(be){if(ba){ad.onClose();}else{ad.onError(be);}};a8.onopen=ad.onOpen;a8.onclose=bb;a8.onerror=bb;a8.onmessage=function(be){if(be.data){ad.d(be.data);}};};this.send=function(bc,bb){a8.send(bb[0]+"&"+bb[1]);if(ad.isConnected()){s.setReady(true);}};this.close=function(){ba=true;a8.close();};};a4[a5.XHR_STREAMING_CORS]=function(a9){this.name=a9;var bd,bb,bc=null;var ba=2000;var be=false;var a8=ad.getCurrentSession().getConfig().maxStreamLengthStreamingCors;this.isClientSupported=function(){return((!!b.XMLHttpRequest)&&typeof(new XMLHttpRequest()).withCredentials!="undefined");};this.usesKeepAlive=function(){return true;};this.open=function(){var bf=false;if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}bc=ad.getCurrentRealm()+"/sv/nvLite";bd=new XMLHttpRequest();bd.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Receiver] "+this.readyState+" : CumulativeResponseLength="+this.responseText.length);}if(this.readyState==3){ba=a7.processResponseChunk(this.responseText,ba);if(this.responseText.length>=a8&&!bf){bf=true;if(W.isLoggingEnabled()){W.Logger.log(4,"["+a9+" Receiver] Reached max stream length "+a8+", resetting.");}s.prioritizeCommand({requestType:aa.CLIENT_CLOSE,clientRequest:false});}}else{if(this.readyState==4||bf){ad.onError("Receiver Connection Closed = "+this.status);}}};bb=new XMLHttpRequest();bb.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Sender] "+this.readyState+" : CumulativeResponseLength="+this.responseText.length);}if(this.readyState==4&&this.status!=200){ad.onError("Sender Connection Status = "+this.status);}else{if(this.readyState>3){ad.c(this.responseText);s.setReady(true);}}};ad.onOpen();};this.send=function(bg,bf){if(!be){if(bg.requestType===aa.SESSION_START){bd.open("GET",bc+"?"+bf[0]);bd.withCredentials=true;bd.send();}else{bb.open("POST",bc+"?"+bf[0]);bb.withCredentials=true;bb.setRequestHeader("Content-Type","text/plain");bb.send(bf[1]);}}};this.close=function(){if(!be){be=true;bd.abort();bd=null;bb.abort();bb=null;ad.onClose();}};};a4[a5.XDR_STREAMING]=function(a9){this.name=a9;var bd,bb,bc=null;var ba=2000;var bf=false;var be=null;var a8=ad.getCurrentSession().getConfig().maxStreamLengthStreamingCors;this.isClientSupported=function(){return(!!b.XDomainRequest);};this.usesKeepAlive=function(){return true;};this.open=function(){var bj=false;if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}function bi(bl,bk){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" "+bl+"] ERROR = "+bk);}ad.onError("["+bl+"] "+bk);}function bh(){}bc=ad.getCurrentRealm()+"/sv/nvLite";bd=new XDomainRequest();bd.timeout=0;bd.onprogress=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Receiver] : CumulativeResponseLength="+this.responseText.length);}ba=a7.processResponseChunk(this.responseText,ba);if(this.responseText.length>=a8&&!bj){bj=true;if(W.isLoggingEnabled()){W.Logger.log(4,"["+a9+" Receiver] Reached max stream length "+a8+", resetting.");}s.prioritizeCommand({requestType:aa.CLIENT_CLOSE,clientRequest:false});}};bd.onerror=function(){bi("Receiver","Unknown XDR Error (are CORS Allowed Origins correct?)");};bd.ontimeout=function(){bi("Receiver","XDR Timeout");};bd.onload=bh;bb=new XDomainRequest();bb.timeout=ad.getCurrentSession().getConfig().openDriverTimeout;bb.onload=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Sender] "+this.responseText);}if(this.responseText){ad.c(this.responseText);}be=setTimeout(bg,0);};function bg(){clearTimeout(be);s.setReady(true);}bb.onerror=function(){bi("Sender","Unknown XDR Error");};bb.ontimeout=function(){bi("Sender","XDR Timeout");};bb.onprogress=bh;ad.onOpen();};this.send=function(bh,bg){if(bh.requestType===aa.SESSION_START){bd.open("GET",bc+"?"+bg[0]);bd.send();}else{bb.open("POST",bc+"?"+bg[0]);bb.send(bg[1]);}};this.close=function(){if(!bf){bf=true;if(be!==null){clearTimeout(be);}bd.abort();bd=null;bb.abort();bb=null;ad.onClose();}};};a4[a5.IFRAME_STREAMING_POSTMESSAGE]=function(a8){this.name=a8;var bd,a9,ba=null;var bb=false;this.isClientSupported=function(){var bg=navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Konqueror")!==-1;return((typeof b.postMessage==="function"||typeof b.postMessage==="object")&&(!bg));};this.usesKeepAlive=function(){return true;};this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}ba=ad.getCurrentRealm()+"/sv/nvLite";s.setReady(false);bd=a9=new W.CrossDomainProxy(ad.getCurrentSession(),this.name,ad.getCurrentRealm(),bf,ad.onError);a9.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+" Sender] "+this.readyState+" : "+this.responseText);}if(this.readyState==4){if(this.status!=200){ad.onError(a8+" sender status "+this.status);}else{if(bb){s.setReady(true);}}}};};function bf(){bb=true;ad.onOpen();}function be(bg){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+" Receiver] "+ad.getCurrentRealm()+"/sv/nvLite?"+bg);}bd.proxyRequest("createForeverIFrame",[ad.getCurrentRealm()+"/sv/nvLite?"+bg]);}function bc(bh,bg){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+" Sender] "+ad.getCurrentRealm()+"/sv/nvLite?"+bg);}a9.open("POST",ba+"?"+bg[0]);a9.send(bg[1]);}this.send=function(bh,bg){if(bh.requestType===aa.SESSION_START){be(bg[0]+"&"+bg[1]);}else{bc(bh,bg);}};this.close=function(){bb=false;a9.abort();a9=null;bd=null;ad.onClose();};};a4[a5.EVENTSOURCE_STREAMING_POSTMESSAGE]=function(a9){this.name=a9;var a8=this;var bc,ba=null;this.isClientSupported=function(){if(!("EventSource" in b)){return false;}var be=navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Konqueror")!==-1;return((typeof b.postMessage==="function"||typeof b.postMessage==="object")&&(!be));};this.usesKeepAlive=function(){return true;};this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}bc=ba=new W.CrossDomainProxy(ad.getCurrentSession(),this.name,ad.getCurrentRealm(),ad.onOpen,ad.onError);ba.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Sender] "+this.readyState+" : "+this.responseText);}if(this.readyState==4){if(this.status!=200){ad.onError(a9+" sender status "+this.status);}else{s.setReady(true);}}};};function bd(be){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Receiver] "+ad.getCurrentRealm()+"/sv/nvLite?"+be);}bc.proxyRequest("createEventSource",ad.getCurrentRealm()+"/sv/nvLite?"+be);a8.send=bb;}function bb(bf,be){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" Sender] "+ad.getCurrentRealm()+"/sv/nvLite?"+be);}ba.open("POST",ad.getCurrentRealm()+"/sv/nvLite?"+be[0],true);ba.send(be[1]);}this.send=function(bf,be){bd(be[0]+"&"+be[1]);};this.close=function(){ba.abort();ba=null;bc=null;ad.onClose();};};a4[a5.XDR_LONGPOLL]=function(a9){this.name=a9;var bb,ba,a8=null;var bd=false;var bc=null;this.isClientSupported=function(){return(!!b.XDomainRequest);};this.usesKeepAlive=function(){return false;};this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}a8=ad.getCurrentRealm()+"/sv/nvLite";function bg(bi,bh){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+" "+bi+"] ERROR = "+bh);}ad.onError("["+bi+"] "+bh);}function bf(){}bb=new XDomainRequest();bb.timeout=0;bb.onload=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+"] receiver: "+this.responseText);}if(this.responseText){ad.d(this.responseText);}if(!bd){setTimeout(a7.longpoll,1);}};bb.onerror=function(){bg("Receiver","Unknown XDR Error (are CORS Allowed Origins correct?)");};bb.ontimeout=function(){bg("Receiver","XDR Timeout");};bb.onprogress=bf;ba=new XDomainRequest();ba.timeout=ad.getCurrentSession().getConfig().openDriverTimeout;ba.onload=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+"] sender: "+this.responseText);}if(this.responseText){ad.d(this.responseText);if(!bd){a7.longpoll();}}bc=setTimeout(be,0);};ba.onerror=function(){bg("Sender","Unknown XDR Error (are CORS Allowed Origins correct?)");};ba.ontimeout=function(){bg("Sender","XDR Timeout");};ba.onprogress=bf;function be(){clearTimeout(bc);s.setReady(true);}ad.onOpen();};this.send=function(bf,be){if(!bd){if(bf.requestType===aa.KEEP_ALIVE||bf.requestType===aa.SESSION_START){if(bb!==null){bb.open("GET",a8+"?"+be[0]);bb.send();}}else{if(ba!==null){ba.open("POST",a8+"?"+be[0]);ba.send(be[1]);}}}};this.close=function(){if(!bd){bd=true;if(bc!==null){clearTimeout(bc);}a7.cancelLongpollTimeout();try{bb.onreadystatechange=null;ba.onreadystatechange=null;bb.abort();ba.abort();}catch(be){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+"] exception on close(): "+be.message);}}bb=null;ba=null;ad.onClose();}};};a4[a5.XHR_LONGPOLL_CORS]=function(a9){this.name=a9;var bb,ba,a8=null;var bc=false;this.isClientSupported=function(){return((!!b.XMLHttpRequest)&&typeof(new XMLHttpRequest()).withCredentials!="undefined");};this.usesKeepAlive=function(){return false;};this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}a8=ad.getCurrentRealm()+"/sv/nvLite";bb=new XMLHttpRequest();bb.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+"] receiver ("+this.readyState+") : "+this.responseText);}if(this.readyState==4){if(this.status!=200){ad.onError(a9+" receiver status "+this.status);}else{ad.d(this.responseText);if(!bc){setTimeout(a7.longpoll,0);}}}};ba=new XMLHttpRequest();ba.onreadystatechange=function(){if(this.readyState==4){if(this.status!=200){ad.onError(a9+" sender status "+this.status);}else{if(this.responseText){ad.d(this.responseText);if(!bc){a7.longpoll();}}s.setReady(true);}}};ad.onOpen();};this.send=function(be,bd){if(!bc){if(be.requestType===aa.KEEP_ALIVE||be.requestType===aa.SESSION_START){bb.open("GET",a8+"?"+bd[0]+"&"+bd[1]);bb.withCredentials=true;bb.send();}else{ba.open("POST",a8+"?"+bd[0]);ba.withCredentials=true;ba.setRequestHeader("Content-Type","text/plain");ba.send(bd[1]);}}};this.close=function(){if(!bc){bc=true;a7.cancelLongpollTimeout();try{bb.onreadystatechange=null;ba.onreadystatechange=null;bb.abort();ba.abort();}catch(bd){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a9+"] exception on close(): "+bd.message);}}bb=null;ba=null;ad.onClose();}};};a4[a5.XHR_LONGPOLL_POSTMESSAGE]=function(a8){this.name=a8;var bb,a9,ba=null;var bc=false;this.isClientSupported=function(){var bd=navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Konqueror")!==-1;return((typeof b.postMessage==="function"||typeof b.postMessage==="object")&&(!bd));};this.usesKeepAlive=function(){return false;};this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}ba=ad.getCurrentRealm()+"/sv/nvLite";bb=new W.CrossDomainProxy(ad.getCurrentSession(),a8,ad.getCurrentRealm(),bd,ad.onError);bb.onreadystatechange=function(){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] receiver: ("+this.readyState+") : "+this.responseText);}if(this.readyState==4){if(this.status!=200){ad.onError(a8+" receiver status "+this.status);}else{ad.d(this.responseText);if(!bc){a7.longpoll();}}}};a9=new W.CrossDomainProxy(ad.getCurrentSession(),a8,ad.getCurrentRealm(),bd,ad.onError);a9.onreadystatechange=function(){if(this.readyState==4){if(this.status!=200){ad.onError(a8+" sender status "+this.status);}else{if(this.responseText){ad.d(this.responseText);if(!bc){a7.longpoll();}}s.setReady(true);}}};function bd(){if(!!bb&&!!a9&&bb.initialized&&a9.initialized){ad.onOpen();}}};this.send=function(be,bd){if(!bc){if(be.requestType===aa.KEEP_ALIVE){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] receiver requesting: "+bd);}bb.open("GET",ba+"?"+bd[0]);bb.send();}else{if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] sender requesting: "+bd);}a9.open("POST",ba+"?"+bd[0]);a9.send(bd[1]);}}};this.close=function(){if(!bc){bc=true;a7.cancelLongpollTimeout();bb.onreadystatechange=null;a9.onreadystatechange=null;bb.abort();a9.abort();bb=null;a9=null;ad.onClose();}};};a4[a5.JSONP_LONGPOLL]=function(a8){this.name=a8;var bc,ba,bb=null;var bd=false;this.id=W.generateUniqueID();this.isClientSupported=function(){return true;};this.usesKeepAlive=function(){return false;};function a9(be){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] receiverResponseHandler: "+be);}if(ad.c(be)){if(ad.isConnected()){s.setReady(true);}}if(!bd){a7.longpoll();}}this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}bb=ad.getCurrentRealm()+"/sv/nvLite";b.LPReadyStateCB=a9;bc=new W.JSONP_Poller(ad.onError);ba=new W.FormSubmitter();ad.onOpen();};this.send=function(bf,be){if(!bd){if(bf.requestType===aa.KEEP_ALIVE||bf.requestType===aa.SESSION_START){if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] Receiver Req: "+be[0]);}bc.send(bb,be);}else{if(W.isLoggingEnabled()){W.Logger.log(1,"["+a8+"] Sender Req: "+be[0]+"&"+be[1]);}ba.send(bb,be);}}};this.close=function(){if(!bd){bd=true;a7.cancelLongpollTimeout();bc.destroy();bc=null;ba.destroy();ba=null;b.LPReadyStateCB=function(){};ad.onClose();}};};a4[a5.NOXD_IFRAME_STREAMING]=function(ba){this.name=ba;var bk=this;var a8,be,bc=null;var bf=0;var bb=false;this.isClientSupported=function(){if(!aX){return true;}var bn=aX.getConfig().realms;var bp=bn.length;var bo=location.host;var bq=new RegExp("https?://"+bo+"/?");for(var bm=0;bm<bp;bm++){var bl=W.getCanonicalOrigin(bn[bm]);if(bq.test(bl)){return true;}}return false;};this.usesKeepAlive=function(){return true;};function bj(bl){if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] receiverCB: "+typeof bl+" "+bl);}if(bl){ad.c(bl);}}function bd(bl){if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] senderCB: "+typeof bl+" "+bl);}if(bl){ad.d(bl);}s.setReady(true);}function bh(bl){ad.onError(bl);}function bg(bl){a8=W.createForeverIFrame(bc+"?"+bl,bj,bh);if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+" Receiver] "+bc+"?"+bl);}bk.send=a9;}function a9(bo,bn){if(!bb){if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+" Sender] "+bc+"?"+bn);}var bl=(bo.requestType===aa.CLIENT_CLOSE);be.open("POST",bc+"?"+bn[0],bl);be.onreadystatechange=bi;be.setRequestHeader("Content-Type","application/x-www-form-urlencoded");try{if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] XHR POST: "+bn);}be.send(bn[1]);return true;}catch(bm){return false;}}}function bi(){if(be===null){if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] statechangecb: Sender is already null");}return;}var bm=be.readyState;if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] statechangecb: State now changed to "+bm);}if(bm!==4){return;}var bo;try{bo=be.status;}catch(bl){if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] statechangecb : failed to read status code");}}if(bo===200||bo===0){bd(be.responseText);}else{if(W.isLoggingEnabled()){W.Logger.log(1,"["+ba+"] statechangecb - status of "+bo+" forcing session reset");}bf++;ad.onError("Error transports has been closed");}var bn=document.getElementById("NVLSubFrame");if(bn){while(bn.hasChildNodes()){bn.removeChild(bn.lastChild);}}}this.open=function(){if(!this.isClientSupported()){ad.onError(this.name+" driver not supported by client");return;}bc=ad.getCurrentRealm()+"/sv/nvLite";be=W.initXMLHTTP("xmlhttp");be.onreadystatechange=bi;b.onMessage=bj;b.errorCB=bh;ad.onOpen();return true;};this.send=function(bm,bl){bg(bl[0]+"&"+bl[1]);};this.close=function(){if(!bb){bb=true;b.onMessage=function(){};b.errorCB=function(){};be.onreadystatechange=function(){};be.abort();if(a8.close){a8.close();}be=null;a8=null;ad.onClose();}};};var a7=(function(){var a8=null;function ba(){if(aQ===null){bc();return;}bc();var be={requestType:aa.KEEP_ALIVE,requestID:aD++};var bd=aX.requestFactory.buildRequest(be);if(W.isLoggingEnabled()){W.Logger.log(1,"["+aQ.name+"] longpoll() sending request number "+aD);}aQ.send(be,bd);a9(aQ.name);}function a9(bd){a8=setTimeout(function(){ad.onError(bd+" Longpoll Timeout");},ad.getConfig().sessionTimeoutMs);}function bc(){if(a8!==null){clearTimeout(a8);}}function bb(bd,bf){if(bf>bd.length){return bf;}var be;do{be=bd.indexOf("];[",bf)+2;if(be===1){if(bd.charAt(bd.length-1)==";"&&bd.charAt(bd.length-2)=="]"){be=bd.length;}else{return bf;}}if(be>bf){ad.d(bd.substring(bf,be-1));bf=be;}}while(be!=bd.length);return bf;}return{longpoll:ba,cancelLongpollTimeout:bc,processResponseChunk:bb};}());return{Names:a5,WireProtocol:a3,createDriver:a6};}());var aV=[];var ah=[aM.Names.WEBSOCKET,aM.Names.XHR_STREAMING_CORS,aM.Names.XDR_STREAMING,aM.Names.IFRAME_STREAMING_POSTMESSAGE,aM.Names.EVENTSOURCE_STREAMING_POSTMESSAGE,aM.Names.XDR_LONGPOLL,aM.Names.XHR_LONGPOLL_CORS,aM.Names.XHR_LONGPOLL_POSTMESSAGE,aM.Names.NOXD_IFRAME_STREAMING,aM.Names.JSONP_LONGPOLL];return{Drivers:aM,initializeDriver:ao,supportsDriver:ax,setPreferredDriver:a1,setUp:aP,open:aF,tearDown:av,getCurrentDriver:aY,getCurrentRealm:aW,getCurrentSession:aS,getConfig:aw,getRequestCountIncrement:aE,stop:aB,getNirvanaCookie:an,onConnect:at,onOpen:aG,onError:az,onClose:aN,send:aJ,c:aj,d:aH,isConnected:aK};}());var s=(function(){var al=false;var ag=[];function ah(){if(al&&ag.length>0){var an=am();if(an!==null){if(an.requestType==aa.SESSION_START&&ad.getCurrentSession().getStatus()===Q.CONNECTED){W.Logger.log(3,"[Outbound Engine] Dequeueing unecessary session start request as already connected.","Req #"+an.requestID);s.dequeueCommand(an.requestID);ah();}else{al=false;an.sent=true;if(W.isLoggingEnabled()){W.Logger.log(3,"[Outbound Engine] Sending Command to Transport Layer.","Req #"+an.requestID);}ad.send(an);}}}}function ae(an){al=an;ah();}function ai(an){an.requestID=ad.getRequestCountIncrement();an.sent=false;if(W.isLoggingEnabled()){W.Logger.log(3,"[Outbound Engine] Queueing Command "+ac(an.requestType),an);}ag.push(an);ah();}function ak(an){an.requestID=ad.getRequestCountIncrement();an.sent=false;ag.unshift(an);if(W.isLoggingEnabled()){W.Logger.log(3,"[Outbound Engine] Prioritizing Command "+ac(an.requestType),an);}ah();}function af(ar){var ao=ag.length;if(W.isLoggingEnabled()){var an="";for(var ap=0;ap<ao;ap++){an+=ac(ag[ap].requestType)+" ";}W.Logger.log(2,"[Outbound Engine] OutboundQueue = "+an);}for(var aq=0;aq<ao;aq++){if(ag[aq].requestID==ar){if(W.isLoggingEnabled()){W.Logger.log(3,"[Outbound Engine] Dequeueing Command "+ac(ag[aq].requestType),ag[aq],ar);}return ag.splice(aq,1)[0];}}if(W.isLoggingEnabled()){W.Logger.log(3,"[Outbound Engine] No matching queued command to dequeue for request ID: ",ar);}return null;}function aj(){if(W.isLoggingEnabled()){W.Logger.log(2,"[Outbound Engine] Resetting messages on outbound queue");}for(var an=0;an<ag.length;an++){if(ag[an].requestType===aa.KEEP_ALIVE||ag[an].requestType===aa.CLIENT_CLOSE){ag.splice(an,1);}else{ag[an].sent=false;ag[an].requestID=ad.getRequestCountIncrement();}}}function am(){var an=ag.length;for(var ao=0;ao<an;ao++){if(!ag[ao].sent){return ag[ao];}}return null;}return{setReady:ae,queueCommand:ai,resetMessagesOnQueue:aj,prioritizeCommand:ak,dequeueCommand:af,peek:am};}());var H;function f(){var ag=[];var af=false;var ae=function(an,am){var ak=ag[an];if(!ag[an]){ak=[];ag[an]=ak;}var al=ak.length;for(var aj=0;aj<al;aj++){if(am==ak[aj]){return;}}if(af){ak=ak.slice(0);ag[an]=ak;}ak.push(am);};var ah=function(an,am){var ak=ag[an];if(!ak){return;}if(am===true){ak=[];ag[an]=ak;}if(af){ak=ak.slice(0);ag[an]=ak;}var al=ak.length;for(var aj=0;aj<al;aj++){if(am==ak[aj]){ak.splice(aj,1);return;}}};var ai=function(ap,ao,an){var ak=ag[ap];if(!ak){return;}af=true;var al=ak.length;for(var aj=0;aj<al;aj++){var am=ak[aj];if(W.isLoggingEnabled()){W.Logger.log(0,"[NotifyListeners] "+am+" : "+an);}am(ao,an);}af=false;};return{on:ae,removeListener:ah,notifyListeners:ai};}function U(af,ae){j[af]=ae;}function v(ae){this.name="AlreadySubscribedException";if(typeof ae!="undefined"&&ae!==null){this.message="Already subscribed to "+ae;}if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function J(ae){this.name="InvalidDriverException";if(typeof ae!="undefined"&&ae!==null){this.message=ae+" is not a valid driver name";}if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function G(ae){this.name="NoValidDriversException";this.message="This client does not support any of the currently configured drivers";if(W.isLoggingEnabled()){W.Logger.log(8,"["+this.name+"] "+this.message,ae);}}function d(ae,af){this.name="DriverSecurityException";if(typeof ae!="undefined"&&ae!==null){this.message=ae+" - "+af;}if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function F(ae,af){this.name="AlreadyCommittedException";this.message="Already Committed Transaction "+af+" to resource "+ae;if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function D(ae,af){this.name="SessionException";if(typeof ae!="undefined"&&ae!==null){this.message=ae+" - "+af;}if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function o(ae){this.name="SecurityException";this.message=ae;if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function q(af,ae){this.name="MissingResourceException";this.resourceName=af;this.message=ae;if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.message);}}function y(ae){this.name="GenericException";if(ae){this.errorMessage=ae;}if(W.isLoggingEnabled()){W.Logger.log(7,"["+this.name+"] "+this.errorMessage);}}function Z(ae){if(H){if(H.getStatus()!==Q.STOPPED&&H.getStatus()!==Q.NOTSTARTED){L.notifyListeners(a.Observe.ERROR,H,{name:"SessionExistsException",message:"Cannot Create Session: Session Already Exists"});return c;}}H=new E(af(ae));return H;function af(aj){function al(ap,ao){if(typeof ap=="undefined"||ap===null){return ao;}return !!ap;}function an(ap,ao){ap=parseInt(ap,10);if(isNaN(ap)){ap=ao;}return ap;}if(typeof aj=="undefined"||aj===null){aj={};}aj.debugLevel=an(aj.debugLevel,9);W.setDebugLevel(aj.debugLevel);if(typeof aj.applicationName=="undefined"){aj.applicationName="GenericJSClient";}if(typeof aj.sessionName=="undefined"){aj.sessionName="GenericJSSession";}if(typeof aj.username=="undefined"){aj.username="JSUser_"+W.generateUniqueID();}if(typeof aj.crossDomainPath=="undefined"){aj.crossDomainPath="/lib/js";}if(typeof aj.realms=="undefined"){var ag=document.location.protocol+"//"+document.location.hostname;if(document.location.host.match(/:[0-9]+$/)){ag+=":"+document.location.port;}else{ag=W.getCanonicalOrigin(ag);}aj.realms=[ag];}var ak=document.location.protocol+"//"+document.location.hostname;if(document.location.protocol!="file:"){if(document.location.host.match(/:[0-9]+$/)){ak+=":"+document.location.port;}else{ak=W.getCanonicalOrigin(ak);}}aj.currentDomain=ak;aj.serverLogging=al(aj.serverLogging,false);aj.verboseKeepalives=al(aj.verboseKeepalives,false);aj.enableDataStreams=al(aj.enableDataStreams,true);aj.sessionTimeoutMs=an(aj.sessionTimeoutMs,120000);aj.sendResponseTimeout=an(aj.sendResponseTimeout,60000);aj.openDriverTimeout=an(aj.openDriverTimeout,15000);aj.maxStreamLengthStreamingCors=an(aj.maxStreamLengthStreamingCors,10000000);aj.rememberDriver=al(aj.rememberDriver,false);if(W.isLoggingEnabled()){var ai="";for(var ah in aj){if(aj.hasOwnProperty(ah)){var am=aj[ah];ai+=ah+":\t";if(am.constructor==Array){ai+=am.join("\n\t\t");}else{ai+=am;}ai+="\n";}}W.Logger.log(5,"[Session] Configuration:\n"+ai);}return aj;}}function T(){return new V(c,-1,c,c,c,c,c,c);}function r(){return l.createDictionary();}function N(af,ae){if(L===null){L=f();U(b.Nirvana,L);}L.on(af,ae);}function g(af,ae){L.removeListener(af,ae);}function E(ag){var ai;var an=this;var al=f();var ah=ag;var am="-1";var aj=Q.NOTSTARTED;var ak=-1;var af=[];var ae={};ae.g1="";U(an,al);this.start=function(){if(!(aj===Q.NOTSTARTED||aj===Q.STOPPED)){j[b.Nirvana].notifyListeners(a.Observe.ERROR,ai,new D("Nirvana Session","start() can only be invoked on a new or stopped session"));return ai;}var ap=(aj===Q.STOPPED);if(document.getElementById(n)===null){a.initialize();if(W.isLoggingEnabled()){W.Logger.log(1,"[Nirvana] Waiting for DOM to be ready");}setTimeout(an.start,15);return ai;}if(W.isLoggingEnabled()){W.Logger.log(6,"[Session] Creating Session");}aj=Q.CONNECTING;var aq={session:an,requestType:aa.SESSION_START,listenerManager:al};s.prioritizeCommand(aq);ad.setUp(an,ap);ad.open();var ao=function(){an.stop(true);};if(b.addEventListener){b.addEventListener("beforeunload",ao,false);}else{if(b.attachEvent){b.attachEvent("onbeforeunload",ao);}}return ai;};this.stop=function(ao){if(W.isLoggingEnabled()){W.Logger.log(6,"[Session] Stopping Session");}if(aj===Q.STOPPED||aj===Q.NOTSTARTED){return ai;}aj=Q.STOPPED;var ap={requestType:aa.CLIENT_CLOSE,clientRequest:true};if(ao){s.prioritizeCommand(ap);}else{s.queueCommand(ap);}return ai;};this.destroy=function(){this.stop();H=null;return ai;};this.subscribe=function(ao){try{var au=[];for(var at=0;at<ao.length;at++){var ar=ao[at];if(ar.isSubscribed()){var aq=new v(ar.getName());ar.notifyListeners(a.Observe.ERROR,ar,aq);al.notifyListeners(a.Observe.ERROR,ai,aq);j[b.Nirvana].notifyListeners(a.Observe.ERROR,ai,aq);}else{au.push(an.getResourceByName(ar.getName()));}}if(ao.length){var av=an.prepareCommand(aa.BATCH_SUBSCRIBE);av.resources=au;s.queueCommand(av);}}catch(ap){if(W.isLoggingEnabled()){W.Logger.logException(8,ap);}j[b.Nirvana].notifyListeners(a.Observe.ERROR,ai,ap);}return ai;};this.getChannel=function(ao){ao=W.getCanonicalResourceName(ao);var ap=an.getResourceByName(ao);if(!ap){var aq=f();ap=new O(ao,aq,an);U(ap,aq);}else{return ap.getClientResource();}return ap;};this.getQueue=function(ar,ap){ar=W.getCanonicalResourceName(ar);var ao=an.getResourceByName(ar);if(!ao){var aq=f();if(ap){ao=new P(ar,aq,an);}else{ao=new ab(ar,aq,an);}U(ao,aq);}else{return ao.getClientResource();}return ao;};this.notifyListeners=function(aq,ap,ao){al.notifyListeners(aq,ap,ao);};this.on=function(ap,ao){al.on(ap,ao);return ai;};this.removeListener=function(ap,ao){al.removeListener(ap,ao);return ai;};this.getUsername=function(){return ah.username;};this.getCurrentDriver=function(){return ad.getCurrentDriver();};this.getCurrentRealm=function(){return ad.getCurrentRealm();};this.pushResource=function(ao){af.push(ao);};this.setGroupAlias=function(ap,ao){ae[ao]=ap;};this.getGroupName=function(ao){return ae[ao];};this.getResources=function(){return af;};this.getResourceByName=function(ap){var aq=af.length;for(var ao=0;ao<aq;ao++){var ar=af[ao];if(ar.getName()==ap){return ar;}}};this.setResourceAlias=function(ap,at){var aq=af.length;for(var ao=0;ao<aq;ao++){var ar=af[ao];if(ar.getName()===ap){ar.setAlias(at);return;}}};this.getResourceByAlias=function(ar){var ap=af.length;for(var ao=0;ao<ap;ao++){var aq=af[ao];if(aq.getAlias()===ar){return aq;}}};this.setSessionID=function(ao){am=""+ao;aj=Q.CONNECTED;};this.getLongPollRequestID=function(){return ak;};this.setLongPollRequestID=function(ao){ak=ao;};this.getSessionID=function(){return am;};this.getConfig=function(){return ah;};this.setStatus=function(ao){aj=ao;};this.getStatus=function(){return aj;};this.isDataStreamEnabled=function(){return ah.enableDataStreams;};this.prepareCommand=function(ao){return{session:this,requestType:ao};};this.requestFactory=W.HTTPRequestFactory();this.responseFactory=W.HTTPResponseFactory(an);ai={on:this.on,removeListener:this.removeListener,isDataStreamEnabled:this.isDataStreamEnabled,getConfig:this.getConfig,getStatus:this.getStatus,getChannel:this.getChannel,getQueue:this.getQueue,getUsername:this.getUsername,getSessionID:this.getSessionID,getCurrentRealm:this.getCurrentRealm,getCurrentDriver:this.getCurrentDriver,start:this.start,stop:this.stop,destroy:this.destroy,subscribe:this.subscribe};return ai;}function O(an,am,ag){var ao=this;var af;var al=am;var ak=false;var aj=0;var ae="";var ai;var ah=-1;this.getClientResource=function(){return af;};this.subscribe=function(){var ap={requestType:aa.RESOURCE_SUBSCRIBE,session:ag,resource:ao};s.queueCommand(ap);return af;};this.unsubscribe=function(){var ap={requestType:aa.RESOURCE_UNSUBSCRIBE,session:ag,resource:ao};s.queueCommand(ap);return af;};this.getAlias=function(){return ai;};this.setAlias=function(ap){ai=ap;};this.setSubscribed=function(ap){ak=ap;if(ak===false){ah=-1;}};this.isSubscribed=function(){return ak;};this.publish=function(ap){var aq={requestType:aa.RESOURCE_PUBLISH,session:ag,resource:ao,event:ap};s.queueCommand(aq);return af;};this.createTransaction=function(){var ap=f();var aq=ag.getSessionID()+W.generateTransactionID();return new M(aq,ap,ao);};this.getStartEID=function(){return aj;};this.setStartEID=function(ap){aj=ap;return af;};this.getCurrentEID=function(){return ah;};this.setCurrentEID=function(ap){ah=ap;};this.getFilter=function(){return ae;};this.setFilter=function(ap){ae=ap;return af;};this.getName=function(){return an;};this.getResourceType=function(){return a.CHANNEL_RESOURCE;};this.on=function(aq,ap){al.on(aq,ap);return af;};this.removeListener=function(aq,ap){al.removeListener(aq,ap);return af;};this.notifyListeners=function(ar,aq,ap){al.notifyListeners(ar,aq,ap);};ag.pushResource(ao);af={on:this.on,removeListener:this.removeListener,subscribe:this.subscribe,unsubscribe:this.unsubscribe,isSubscribed:this.isSubscribed,publish:this.publish,createTransaction:this.createTransaction,getStartEID:this.getStartEID,setStartEID:this.setStartEID,getFilter:this.getFilter,setFilter:this.setFilter,getName:this.getName,getResourceType:this.getResourceType};return af;}function ab(ag,al,ah){var am=this;var af;var ak=al;var aj=false;var ae="";var ai;this.getClientResource=function(){return af;};this.subscribe=function(){var an={requestType:aa.RESOURCE_SUBSCRIBE,session:ah,resource:am};s.queueCommand(an);return af;};this.unsubscribe=function(){var an={requestType:aa.RESOURCE_UNSUBSCRIBE,session:ah,resource:am};s.queueCommand(an);return af;};this.getAlias=function(){return ai;};this.setAlias=function(an){ai=an;};this.setSubscribed=function(an){aj=an;};this.isSubscribed=function(){return aj;};this.publish=function(an){var ao={requestType:aa.RESOURCE_PUBLISH,session:ah,resource:am,event:an};s.queueCommand(ao);return af;};this.createTransaction=function(){var an=f();var ao=ah.getSessionID()+W.generateTransactionID();return new M(ao,an,am);};this.getFilter=function(){return ae;};this.setFilter=function(an){ae=an;return af;};this.getName=function(){return ag;};this.getResourceType=function(){return a.QUEUE_RESOURCE;};this.on=function(ao,an){ak.on(ao,an);return af;};this.removeListener=function(ao,an){ak.removeListener(ao,an);return af;};this.notifyListeners=function(ap,ao,an){ak.notifyListeners(ap,ao,an);};ah.pushResource(am);af={on:this.on,removeListener:this.removeListener,subscribe:this.subscribe,unsubscribe:this.unsubscribe,isSubscribed:this.isSubscribed,publish:this.publish,getFilter:this.getFilter,setFilter:this.setFilter,getName:this.getName,getResourceType:this.getResourceType,createTransaction:this.createTransaction};return af;}function P(ag,am,ah){var an=this;var af;var aj=false;var ak=am;var ae="";var al=5;var ai;this.getClientResource=function(){return af;};this.subscribe=function(){var ao={requestType:aa.RESOURCE_SUBSCRIBE,session:ah,resource:an};s.queueCommand(ao);return af;};this.unsubscribe=function(){var ao={requestType:aa.RESOURCE_UNSUBSCRIBE,session:ah,resource:an};s.queueCommand(ao);return af;};this.getAlias=function(){return ai;};this.setAlias=function(ao){ai=ao;};this.setSubscribed=function(ao){aj=ao;};this.isSubscribed=function(){return aj;};this.publish=function(ao){var ap={requestType:aa.RESOURCE_PUBLISH,session:ah,resource:an,event:ao};s.queueCommand(ap);return af;};this.createTransaction=function(){var ao=f();var ap=ah.getSessionID()+W.generateTransactionID();return new M(ap,ao,an);};this.commit=function(ao){var ap={requestType:aa.QUEUE_COMMIT,session:ah,resource:an,event:ao};s.queueCommand(ap);return af;};this.commitAll=function(){var ao={requestType:aa.QUEUE_COMMIT,session:ah,resource:an,event:event};s.queueCommand(ao);return af;};this.rollback=function(ao){var ap={requestType:aa.QUEUE_ROLLBACK,session:ah,resource:an,event:ao};s.queueCommand(ap);return af;};this.getFilter=function(){return ae;};this.setFilter=function(ao){ae=ao;return af;};this.getWindowSize=function(){return al;};this.setWindowSize=function(ao){al=ao;return af;};this.getName=function(){return ag;};this.getResourceType=function(){return a.TRANSACTIONAL_QUEUE_RESOURCE;};this.on=function(ap,ao){ak.on(ap,ao);return af;};this.removeListener=function(ap,ao){ak.removeListener(ap,ao);return af;};this.notifyListeners=function(aq,ap,ao){ak.notifyListeners(aq,ap,ao);};ah.pushResource(an);af={on:this.on,removeListener:this.removeListener,subscribe:this.subscribe,unsubscribe:this.unsubscribe,isSubscribed:this.isSubscribed,publish:this.publish,commitAll:this.commitAll,commit:this.commit,rollback:this.rollback,getFilter:this.getFilter,setFilter:this.setFilter,getWindowSize:this.getWindowSize,setWindowSize:this.setWindowSize,getName:this.getName,getResourceType:this.getResourceType,createTransaction:this.createTransaction};return af;}function V(ak,ag,aj,af,ai,ah,ae,al){this.parentSession=ak;this.dictionary=al;this.eventAttributes=ai;this._data=ah;this.tag=ae;this.ttl=0;this.resource=aj;this.eventID=ag;this.resourceName=af;}V.prototype.getSession=function e(){return this.parentSession;};V.prototype.getResource=function A(){return this.resource;};V.prototype.getResourceName=function B(){return this.resourceName;};V.prototype.getTTL=function m(){return this.ttl;};V.prototype.setTTL=function t(ae){this.ttl=ae;return this;};V.prototype.getEID=function K(){return this.eventID;};V.prototype.getData=function w(ae){if(ae==a.BYTE_ARRAY_AS_BASE64_STRING){return this._data;}else{if(ae==a.BYTE_ARRAY_AS_INT_ARRAY){return W.base64Decode(this._data,true);}else{return W.base64Decode(this._data);}}};V.prototype.setData=function z(ae,af){if(af==a.BYTE_ARRAY_AS_BASE64_STRING){this._data=ae;}else{if(af==a.BYTE_ARRAY_AS_INT_ARRAY){this._data=W.base64Encode(ae,true);}else{this._data=W.base64Encode(ae);}}return this;};V.prototype.getTag=function S(){return this.tag;};V.prototype.setTag=function X(ae){this.tag=ae;return this;};V.prototype.getDictionary=function x(){if(!this.dictionary){this.dictionary=new l({});}return this.dictionary;};V.prototype.getEventAttributes=function p(){if(!this.eventAttributes){this.eventAttributes=new h({});}return this.eventAttributes;};V.prototype.hasData=function R(){return this._data!==c;};V.prototype.hasTag=function Y(){return this.tag!==c;};V.prototype.hasDictionary=function I(){return this.dictionary!==c;};l.STRING=0;l.LONG=1;l.DOUBLE=2;l.BOOLEAN=3;l.INTEGER=4;l.FLOAT=5;l.CHARACTER=6;l.BYTE=7;l.DICTIONARY=9;l.ARRAY=-1;l.createDictionary=function(){return new l({});};function l(ae){this.innerProperties=ae;}l.prototype.getKeys=function(){var af=[];for(var ae in this.innerProperties){if(this.innerProperties.hasOwnProperty(ae)){af.push(ae);}}return af;};l.prototype.get=function(ae){if(this.innerProperties.hasOwnProperty(ae)){if(this.innerProperties[ae].length>2){return this.innerProperties[ae][2];}return this.innerProperties[ae][1];}else{return null;}};l.prototype.getType=function(ae){return this.innerProperties[ae][0];};l.prototype.getArrayType=function(ae){return this.innerProperties[ae][1];};l.prototype.put=function(ae,ag,af){this.innerProperties[ae]=[af,ag];return this;};l.prototype.putString=function(ae,af){this.innerProperties[ae]=[l.STRING,af];return this;};l.prototype.putLong=function(ae,af){this.innerProperties[ae]=[l.LONG,af];return this;};l.prototype.putDouble=function(ae,af){this.innerProperties[ae]=[l.DOUBLE,af];return this;};l.prototype.putBoolean=function(ae,af){this.innerProperties[ae]=[l.BOOLEAN,af];return this;};l.prototype.putInteger=function(ae,af){this.innerProperties[ae]=[l.INTEGER,af];return this;};l.prototype.putFloat=function(ae,af){this.innerProperties[ae]=[l.FLOAT,af];return this;};l.prototype.putChar=function(ae,af){this.innerProperties[ae]=[l.CHARACTER,af];return this;};l.prototype.putByte=function(ae,af){this.innerProperties[ae]=[l.BYTE,af];return this;};l.prototype.putDictionary=function(ae,af){this.innerProperties[ae]=[l.DICTIONARY,af];return this;};l.prototype.putArray=function(af,ag,ae){this.innerProperties[af]=[l.ARRAY,ae,ag];return this;};h.HEADER_KEYS=["_allowMerging","pubHost","pubName","subHost","subName","subID","messageType"];h.SERVER_HEADER_KEYS=["timeStamp","_isDelta","_isRedelivered","_isRegistered","deadEID","deadEventChannel","joinEID","joinChannel","joinRealm","joinPath"];h.JMS_HEADER_KEYS=["messageID","correlationID","type","expiration","destination","deliveryMode","priority","userID","appID","replyToName","replyToType"];function h(ae){this.innerAttributes=ae;}h.prototype.getSubscriberHost=function(){return this.innerAttributes.subHost;};h.prototype.getSubscriberName=function(){return this.innerAttributes.subName;};h.prototype.getSubscriberID=function(){return this.innerAttributes.subID;};h.prototype.getPublisherHost=function(){return this.innerAttributes.pubHost;};h.prototype.getPublisherName=function(){return this.innerAttributes.pubName;};h.prototype.setSubscriberHost=function(ae){this.innerAttributes.subHost=ae;return this;};h.prototype.setSubscriberName=function(ae){this.innerAttributes.subName=ae;return this;};h.prototype.setSubscriberNames=function(ae){this.innerAttributes.subName=ae;return this;};h.prototype.setPublisherName=function(ae){this.innerAttributes.pubName=ae;return this;};h.prototype.setPublisherHost=function(ae){this.innerAttributes.pubHost=ae;return this;};h.prototype.getAttribute=function(ae){return this.innerAttributes[ae];};h.prototype.getAttributeNames=function(){var ae=[];for(var af in this.innerAttributes){if(this.innerAttributes.hasOwnProperty(af)){ae.push(af);}}return ae;};h.prototype.setAttribute=function(ae,af){this.innerAttributes[ae]=af;return this;};h.prototype.getTimeStamp=function(){return this.innerAttributes.timeStamp;};h.prototype.getAllowMerge=function(){return this.innerAttributes._allowMerging;};h.prototype.isDelta=function(){return this.innerAttributes._isDelta;};h.prototype.isRedelivered=function(){return this.innerAttributes._isRedelivered;};h.prototype.isRegistered=function(){return this.innerAttributes._isRegistered;};h.prototype.getJoinChannel=function(){return this.innerAttributes.joinChannel;};h.prototype.getJoinEID=function(){return this.innerAttributes.joinEID;};h.prototype.getJoinPath=function(){return this.innerAttributes.joinPath;};h.prototype.getJoinRealm=function(){return this.innerAttributes.joinRealm;};h.prototype.getDeadEID=function(){return this.innerAttributes.deadEID;};h.prototype.getDeadEventStore=function(){return this.innerAttributes.deadEventChannel;};h.prototype.getApplicationID=function(){return this.innerAttributes.appID;};h.prototype.getCorrelationID=function(){return this.innerAttributes.correlationID;};h.prototype.getDeliveryMode=function(){return this.innerAttributes.deliveryMode;};h.prototype.getDestination=function(){return this.innerAttributes.destination;};h.prototype.getExpiration=function(){return this.innerAttributes.expiration;};h.prototype.getMessageID=function(){return this.innerAttributes.messageID;};h.prototype.getMessageType=function(){return this.innerAttributes.messageType;};h.prototype.getPriority=function(){return this.innerAttributes.priority;};h.prototype.getRedeliveredCount=function(){return this.innerAttributes.redeliveredCount;};h.prototype.getReplyToName=function(){return this.innerAttributes.replyToName;};h.prototype.getReplyType=function(){return this.innerAttributes.replyToType;};h.prototype.getType=function(){return this.innerAttributes.type;};h.prototype.getUserID=function(){return this.innerAttributes.userID;};h.prototype.setAllowMerge=function(ae){this.innerAttributes._allowMerging=ae;return this;};h.prototype.setApplicationID=function(ae){this.innerAttributes.appID=ae;return this;};h.prototype.setCorrelationID=function(ae){this.innerAttributes.correlationID=ae;return this;};h.prototype.setDeliveryMode=function(ae){this.innerAttributes.deliveryMode=ae;return this;};h.prototype.setDestination=function(ae){this.innerAttributes.destination=ae;return this;};h.prototype.setExpiration=function(ae){this.innerAttributes.expiration=ae;return this;};h.prototype.setMessageID=function(ae){this.innerAttributes.messageID=ae;return this;};h.prototype.setMessageType=function(ae){this.innerAttributes.messageType=ae;return this;};h.prototype.setPriority=function(ae){this.innerAttributes.priority=ae;return this;};h.prototype.setReplyToName=function(ae){this.innerAttributes.replyToName=ae;return this;};h.prototype.setReplyType=function(ae){this.innerAttributes.replyToType=ae;return this;};h.prototype.setType=function(ae){this.innerAttributes.type=ae;return this;};h.prototype.setUserID=function(ae){this.innerAttributes.userID=ae;return this;};h.prototype.setSubscriberID=function(ae){this.innerAttributes.subID=ae;return this;};function M(ah,al,ae){var an=this;var ag;var ak=al;var ai=ae;var af;var aj=false;var am=false;this.getTxID=function(){return ah;};this.publishAndCommit=function(){if(am){throw new F(ai.getName(),ah);}var ao={requestType:aa.TX_PUBLISH,transaction:an,resource:ai,event:af};s.queueCommand(ao);return ag;};this.setIsCommitted=function(ao){aj=ao;};this.checkCommitStatus=function(ao){if(aj||!ao){ak.notifyListeners(u.COMMIT,ag,true);}var ap={requestType:aa.TX_IS_COMMITTED,transaction:an};s.queueCommand(ap);return ag;};this.setEvent=function(ao){if(am){throw new F(ai.getName(),ah);}af=ao;return ag;};this.on=function(ap,ao){ak.on(ap,ao);return ag;};this.removeListener=function(ap,ao){ak.removeListener(ap,ao);return ag;};this.notifyListeners=function(aq,ap,ao){ak.notifyListeners(aq,ap,ao);};ag={on:this.on,removeListener:this.removeListener,checkCommitStatus:this.checkCommitStatus,publishAndCommit:this.publishAndCommit,setEvent:this.setEvent};return ag;}function k(){var ae=null;var af=function(){try{if(document.getElementById(n)===null){var ah=document.createElement("span");ah.style.display="none";ah.setAttribute("id",n);var ag=document.getElementsByTagName("body")[0];ag.appendChild(ah);clearInterval(ae);}}catch(ai){}};af();if(document.getElementById(n)===null){ae=setInterval(function(){af();},10);}}function ac(ae){return C(aa,ae)+" ["+ae+"]";}function C(af,ag){for(var ae in af){if(af.hasOwnProperty(ae)&&af[ae]==ag){return ae;}}}return{VERSION_NUMBER:"_VERSION_MAJOR_._VERSION_MINOR_",BUILD_NUMBER:"Build 12314",BUILD_DATE:"December 2 2013",Observe:u,BYTE_ARRAY_AS_STRING:0,BYTE_ARRAY_AS_BASE64_STRING:1,BYTE_ARRAY_AS_INT_ARRAY:2,CHANNEL_RESOURCE:1,QUEUE_RESOURCE:2,TRANSACTIONAL_QUEUE_RESOURCE:3,Driver:ad.Drivers.Names,clientSupportsDriver:ad.supportsDriver,initialize:k,createSession:Z,createEvent:T,createDictionary:r,on:N,removeListener:g,Utils:{isLoggingEnabled:W.isLoggingEnabled,Logger:W.Logger,base64Encode:W.base64Encode,base64Decode:W.base64Decode},EventDictionary:{STRING:0,LONG:1,DOUBLE:2,BOOLEAN:3,INTEGER:4,FLOAT:5,CHARACTER:6,BYTE:7,DICTIONARY:9,ARRAY:-1}};}());b.Nirvana=a;a.on(a.Observe.ERROR,function(e,d){a.Utils.Logger.log(8,"System Error: "+d.message,e);});if(b.addEventListener){b.addEventListener("load",a.initialize,false);}else{if(b.attachEvent){b.attachEvent("onload",a.initialize);}}}(window));